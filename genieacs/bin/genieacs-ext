#!/usr/bin/env node
"use strict";var n=new Set,o=process.argv[2],c;function a(e){if(!e)return null;if(!e.name)return{code:"ext",message:`${e}`};let s={code:`ext.${e.name}`,message:e.message,detail:{name:e.name,message:e.message}};if(e.stack){s.detail.stack=e.stack;let t=s.detail.stack.match(/\s+at\s[^\s]+\s\(.*genieacs-ext:.+\)/);t&&(s.detail.stack=s.detail.stack.slice(0,t.index))}return s}process.on("unhandledRejection",e=>{throw e});process.on("uncaughtException",e=>{let s=a(e);n.forEach(t=>{process.send([t,s,null])}),n.clear(),process.disconnect()});process.on("message",e=>{if(n.add(e[0]),!c){let t=process.env.GENIEACS_EXT_DIR;process.chdir(t),c=require(`${t}/${o}`)}let s=e[1][0];if(!c[s]){let t={code:"ext",message:`No such function '${s}' in extension '${o}'`};process.send([e[0],t,null]);return}c[s](e[1].slice(1),(t,i)=>{n.delete(e[0])&&process.send([e[0],a(t),i])})});process.on("SIGINT",()=>{});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vYmluL2dlbmllYWNzLWV4dC50cyJdLAogICJtYXBwaW5ncyI6ICI7YUFFQSxJQUFNQSxFQUFPLElBQUksSUFDWEMsRUFBVyxRQUFRLEtBQUssQ0FBQyxFQUMzQkMsRUFFSixTQUFTQyxFQUFhQyxFQUFtQixDQUN2QyxHQUFJLENBQUNBLEVBQUssT0FBTyxLQUVqQixHQUFJLENBQUNBLEVBQUksS0FBTSxNQUFPLENBQUUsS0FBTSxNQUFPLFFBQVMsR0FBR0EsQ0FBRyxFQUFHLEVBRXZELElBQU1DLEVBQWUsQ0FDbkIsS0FBTSxPQUFPRCxFQUFJLElBQUksR0FDckIsUUFBU0EsRUFBSSxRQUNiLE9BQVEsQ0FDTixLQUFNQSxFQUFJLEtBQ1YsUUFBU0EsRUFBSSxPQUNmLENBQ0YsRUFFQSxHQUFJQSxFQUFJLE1BQU8sQ0FDYkMsRUFBTSxPQUFPLE1BQVdELEVBQUksTUFFNUIsSUFBTUUsRUFBaUJELEVBQU0sT0FBTyxNQUFTLE1BQzNDLHNDQUNGLEVBQ0lDLElBQ0ZELEVBQU0sT0FBTyxNQUFXQSxFQUFNLE9BQU8sTUFBUyxNQUM1QyxFQUNBQyxFQUFlLEtBQ2pCLEVBRUosQ0FFQSxPQUFPRCxDQUNULENBR0EsUUFBUSxHQUFHLHFCQUF1QkQsR0FBUSxDQUN4QyxNQUFNQSxDQUNSLENBQUMsRUFFRCxRQUFRLEdBQUcsb0JBQXNCQSxHQUFRLENBQ3ZDLElBQU1DLEVBQVFGLEVBQWFDLENBQUcsRUFDOUJKLEVBQUssUUFBU08sR0FBVSxDQUN0QixRQUFRLEtBQUssQ0FBQ0EsRUFBT0YsRUFBTyxJQUFJLENBQUMsQ0FDbkMsQ0FBQyxFQUNETCxFQUFLLE1BQU0sRUFDWCxRQUFRLFdBQVcsQ0FDckIsQ0FBQyxFQUVELFFBQVEsR0FBRyxVQUFZUSxHQUFZLENBR2pDLEdBRkFSLEVBQUssSUFBSVEsRUFBUSxDQUFDLENBQUMsRUFFZixDQUFDTixFQUFRLENBQ1gsSUFBTU8sRUFBTSxRQUFRLElBQUksaUJBQ3hCLFFBQVEsTUFBTUEsQ0FBRyxFQUNqQlAsRUFBUyxRQUFRLEdBQUdPLENBQUcsSUFBSVIsQ0FBUSxFQUFFLENBQ3ZDLENBRUEsSUFBTVMsRUFBV0YsRUFBUSxDQUFDLEVBQUUsQ0FBQyxFQUU3QixHQUFJLENBQUNOLEVBQU9RLENBQVEsRUFBRyxDQUNyQixJQUFNTCxFQUFRLENBQ1osS0FBTSxNQUNOLFFBQVMscUJBQXFCSyxDQUFRLG1CQUFtQlQsQ0FBUSxHQUNuRSxFQUNBLFFBQVEsS0FBSyxDQUFDTyxFQUFRLENBQUMsRUFBR0gsRUFBTyxJQUFJLENBQUMsRUFDdEMsTUFDRixDQUVBSCxFQUFPUSxDQUFRLEVBQUVGLEVBQVEsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxFQUFHLENBQUNKLEVBQUtPLElBQVEsQ0FDN0NYLEVBQUssT0FBT1EsRUFBUSxDQUFDLENBQUMsR0FFM0IsUUFBUSxLQUFLLENBQUNBLEVBQVEsQ0FBQyxFQUFHTCxFQUFhQyxDQUFHLEVBQUdPLENBQUcsQ0FBQyxDQUNuRCxDQUFDLENBQ0gsQ0FBQyxFQUdELFFBQVEsR0FBRyxTQUFVLElBQU0sQ0FFM0IsQ0FBQyIsCiAgIm5hbWVzIjogWyJqb2JzIiwgImZpbGVOYW1lIiwgInNjcmlwdCIsICJlcnJvclRvRmF1bHQiLCAiZXJyIiwgImZhdWx0IiwgInN0YWNrVHJpbUluZGV4IiwgImpvYklkIiwgIm1lc3NhZ2UiLCAiY3dkIiwgImZ1bmNOYW1lIiwgInJlcyJdCn0K
